#!/bin/bash
rm rose_b*
filenamex="$1"

filenamenx=$( echo "$filenamex" |sed  's/ /+/g')

vz=$(curl  "https://www.ecosia.org/images?q=${filenamex}&imageType=transparent&color=colorOnly"   |grep -o "http[^\"]*\.\(png\|jpg\|jpeg\)"   |grep -v "ecosia" |sed -n "1 p")

curl   -L "$vz" -o mm.png

convert mm.png -brightness-contrast -10,10 -gamma 0.8 rmm.png
cp rmm.png  mm.png 

convert mm.png -fill gray    -fuzz 4%   -opaque   "white"  mmz.png

cp  mmz.png  mm.png
convert mm.png  -background blue -flatten   mmmkk.png

convert mmmkk.png  -fill black      +opaque   "blue"    -negate  -fill black   -opaque   "yellow"  -morphology erode Octagon:5   mmmkk3.png



convert  mm.png  \(  mmmkk3.png  \) -alpha off -compose copy_opacity -composite MMMresult.png
cp MMMresult.png  mm.png


 


convert "$2" /home/diegonode/Desktop/createtato/fondo2.png

siky=$(identify -format "%w" mm.png)

sikz=$(identify -format "%h" mm.png)


echo "$(($sikz * $sikz))"

echo "$(($sikz * 2))"

varm="$(($sikz * $siky))"
echo "21291 tamaÃ±o de manobroacha"

echo "$(($varm * 9))"
 
 echo "scale=2; $varm / 21291" | bc>varoz

varom="$(cat varoz)"


varzm=$(printf "$varom" | awk '{print sqrt($0)}')
echo $varzm
mll="$3"
 
 echo "($mll + 1)" | bc>scccc
scx=$(cat scccc)

echo $scx

 


mln=$mll
 
echo $mln

echo " scale=2; $sikz*${scx}/1" | bc>cormegay
echo "scale=2; $siky*${scx}/1" | bc>cormegax
 

w=$(cat cormegax)
 h=$(cat cormegay)
echo "scale=2; $varzm*${mln}/1" | bc > scalex


convert armxz3.png -resize 50% -scale 200% armxz35.png
 convert armxz35.png armxz3.png
 python quant.py --image "armxz3.png"    --clusters 11



convert  image2.png     -define "connected-components:area-threshold=60" -define connected-components:verbose=true -connected-components 4 objects.png |grep "0,0,0"


 


convert armxz3.png -fill white    -fuzz 18%   +opaque   "blue" -fill blue    -fuzz 60%   -opaque   "blue"  armxz3n.png
convert  armxz3n.png    armxz3nz.png
convert  armxz3nz.png     -define "connected-components:area-threshold=60" -define connected-components:verbose=true -connected-components 4 objects.png


sikm=$(identify -format "%w" armxz3.png)


xvd=$(convert  armxz3nz.png     -define "connected-components:area-threshold=60" -define connected-components:verbose=true -connected-components 4 objects.png |grep "0,0,255" |grep -o "+[0-9]*+[0-9]*"|grep -o "[0-9][0-9]*+[0-9][0-9]*"|grep -o "[0-9][0-9]*+"|grep -o "[0-9][0-9]*")


yvd=$(convert  armxz3nz.png     -define "connected-components:area-threshold=60" -define connected-components:verbose=true -connected-components 4 objects.png |grep "0,0,255" |grep -o "+[0-9]*+[0-9]*"|grep -o "[0-9][0-9]*+[0-9][0-9]*" |grep -o "+[0-9][0-9]*"|grep -o "[0-9][0-9]*")

 

scl=$(convert  armxz3nz.png     -define "connected-components:area-threshold=60" -define connected-components:verbose=true -connected-components 4 objects.png |grep "0,0,255" |grep -o "[0-9]*x[0-9]*"  |sed  's/x/:/g')


cr=$(convert  armxz3nz.png     -define "connected-components:area-threshold=60" -define connected-components:verbose=true -connected-components 4 objects.png |grep "0,0,255" |grep -o "[0-9][0-9]*x[0-9][0-9]*+[0-9][0-9]*+[0-9][0-9]*"  )


scnl=$(convert  armxz3nz.png     -define "connected-components:area-threshold=60" -define connected-components:verbose=true -connected-components 4 objects.png |grep "0,0,255" |grep -o "[0-9]*x[0-9]*"  |sed  's/x/x/g'|sed -n "1 p")




convert mm.png -flatten inde.png
 
 
 python denoise.py
 
 

  convert cc2.png +dither -posterize 6 cc3.png


 python quant.py --image "cc3.png"    --clusters 8


sziky=$(identify -format "%w" image2.png)

szikz=$(identify -format "%h" image2.png)


mh=$(echo "$(($szikz * $szikz))")

mj=$(echo "$mh / 32000"|bc)
 

convert    image2.png  -define "connected-components:area-threshold=$mj" -define connected-components:mean-color=true -connected-components 16    image3.png
convert image3.png  colo.png

python convertbmp.py
autotrace -output-file zzzzmegzouput3.svg -output-format svg --color-count 32  test1.bmp

vz=$( curl -F "file=@test1.bmp" https://file.io|grep -o "http[^\"]*")



curl 'https://www.autotracer.org/' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Content-Type: multipart/form-data; boundary=---------------------------13816536491938700077624108726' -H 'Origin: https://www.autotracer.org' -H 'Connection: keep-alive' -H 'Referer: https://www.autotracer.org/' -H 'Cookie: _ga=GA1.2.1792606186.1605054285; _gid=GA1.2.32206776.1605054285; _gat_gtag_UA_150644315_4=1' -H 'Upgrade-Insecure-Requests: 1' --data-binary $'-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="userfile"; filename=""\r\nContent-Type: application/octet-stream\r\n\r\n-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="userfile_url"\r\n\r\nhttps://upload.wikimedia.org/wikipedia/commons/4/47/PNG_transparency_demonstration_1.png\r\n-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="requiredfile_userfile"\r\n\r\n1\r\n-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="outFormat"\r\n\r\nsvg\r\n-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="colorCount"\r\n\r\n32\r\n-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="smooth"\r\n\r\n0\r\n-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="despeckle"\r\n\r\n1\r\n-----------------------------13816536491938700077624108726\r\nContent-Disposition: form-data; name="user_screen_width"\r\n\r\n980\r\n-----------------------------13816536491938700077624108726--\r\n'>svgfinal


curl 'https://www.autotracer.org/' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Content-Type: multipart/form-data; boundary=---------------------------39832853374667870142489333036' -H 'Origin: https://www.autotracer.org' -H 'Connection: keep-alive' -H 'Referer: https://www.autotracer.org/' -H 'Cookie: _ga=GA1.2.1792606186.1605054285; _gid=GA1.2.32206776.1605054285; _gat_gtag_UA_150644315_4=1' -H 'Upgrade-Insecure-Requests: 1' --data-raw ''
 

siky=$(identify -format "%w" mm.png)

sikz=$(identify -format "%h" mm.png)

cat zzzzmegzouput3.svg |sed -z "s/\n[^\n]*L$siky[^\n]*//g"  >zzzzmegzouput3ML.svg

cat zzzzmegzouput3ML.svg>zzzzmegzouput3.svg
 
echo "dibujando"
zetc=$( cat cordn )
cd /home/diegonode/Desktop/createtato
  
echo "21767821953125"|sudo  -S rm  /home/diegonode/Desktop/createtato/megaline/*
echo "21767821953125"|sudo  -S  rm  /home/diegonode/Desktop/createtato/megaline/other/*
groovy getsvgline "2"
cd /home/diegonode/Desktop/createtato/megaline
mkdir other
 

 
convert /home/diegonode/Desktop/createtato/fondo2.png -resize "${w}x${h}"\! /home/diegonode/Desktop/createtato/fondo3.png

 time parallel   convert /home/diegonode/Desktop/createtato/skyz.jpg  \\\( \\\( /home/diegonode/Desktop/createtato/fondo3.png \\\) \\\(  {}    -fill blue    -fuzz 10%    -opaque   "black"    \\\(    -transparent blue   \\\) \\\)  -composite    -resize "$scnl"\!  -fuzz 20% -transparent white \\\)  -geometry "$zetc" -composite  other/{.}.jpg ::: *svg



 



 
 
echo "$scnl"

 


 ffmpeg -y -framerate 3 -pattern_type glob -i '/home/diegonode/Desktop/createtato/megaline/other/*.jpg' -vf pad="width=ceil(iw/2)*2:height=ceil(ih/2)*2"   -c:v libx264 -r 30 -pix_fmt yuv420p zzmoutx.mp4  -vf pad="width=ceil(iw/2)*2:height=ceil(ih/2)*2"

cd /home/diegonode/Desktop/createtato


echo ""
 
echo "21767821953125"|sudo  -S yes| rm /home/diegonode/Desktop/createtato/svgpaint/*
 echo "21767821953125"|sudo  -S  yes| rm  /home/diegonode/Desktop/createtato/svgpaint/other/*
export JAVA_OPTS="$JAVA_OPTS -Xss16m" 
 echo "21767821953125"|sudo  -S   mv /home/diegonode/Desktop/createtato/megaline/other/final.jpg /home/diegonode/Desktop/createtato/skyz.jpg
cp manobrocha2-2.svg   manobrocha2.svg
groovy getsvgdraw "2"


cd /home/diegonode/Desktop/createtato/svgpaint/
mul=$(ls /home/diegonode/Desktop/createtato/svgpaint/ | wc -l)

myp=$(echo "$mul / 200"|bc)
echo $myp
cm="4"

mkdir other

echo "">execmagi
if [[ $myp -gt  1 ]]; then
ls |awk "NR%${myp}==0"|grep ".............."  |sed  "s/\(.*\)\.svg/cp \1.svg \/home\/diegonode\/Desktop\/createtato\/svgpaint\/magna\1.svg/g">execmagi
echo "21767821953125"|sudo  -S chmod 777 execmagi
echo "21767821953125"|sudo  -S ./execmagi
echo "removefilesx"
echo "21767821953125"|sudo  -S yes| rm  jjmega*
fi



 time parallel   convert  /home/diegonode/Desktop/createtato/skyz.jpg \\\( {}  -resize "$scnl"\!  -fuzz 20% -transparent white  \\\)   -geometry  "$zetc" -composite   other/{.}.jpg ::: *svg
 ffmpeg -y -framerate 3 -pattern_type glob -i '/home/diegonode/Desktop/createtato/svgpaint/other/*.jpg' -vf pad="width=ceil(iw/2)*2:height=ceil(ih/2)*2"   -c:v libx264 -r 30 -pix_fmt yuv420p zzmoutx.mp4  -vf pad="width=ceil(iw/2)*2:height=ceil(ih/2)*2"

cd /home/diegonode/Desktop/createtato 
ffmpeg  -y -f concat -safe 0 -i concatdibujo -c copy dibujooutput.mp4 

ffmpeg -y -i dibujooutput.mp4   -aspect 1080:720 -c copy  dibujooutput2.mp4 
sudo -u diegonode ffmpeg -y -i dibujooutput2.mp4  -vcodec copy -acodec copy dibujooutput4.mp4

